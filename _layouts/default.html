<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ site.url }}{{ page.url }}">
    <meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}">
    <meta property="og:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
    <meta property="og:image" content="{{ site.url }}/assets/images/MainMenuBackground.webp">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ site.url }}{{ page.url }}">
    <meta property="twitter:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}">
    <meta property="twitter:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
    <meta property="twitter:image" content="{{ site.url }}/assets/images/MainMenuBackground.webp">
    
    <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
    <link rel="icon" type="image/x-icon" href="{{ '/favicon.ico' | relative_url }}">
</head>
<body>
    <header class="site-header">
        <nav class="site-nav">
            <div class="nav-container">
                <div class="nav-brand">
                    <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
                </div>
                <div class="nav-links">
                    <a href="#mechanics" class="nav-link">Mechanics</a>
                    <a href="#gallery" class="nav-link">Gallery</a>
                    <a href="http://downloads.ira-chartarum.com/IraUpdater.zip" class="btn btn-primary" target="_blank">Download</a>
                    <a href="https://discord.gg/Ywz5UYpf" class="btn btn-secondary" target="_blank">Discord</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="site-main">
        {{ content }}
    </main>

    <footer class="site-footer section-dark">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>{{ site.title }}</h3>
                    <p>{{ site.description }}</p>
                </div>
                <div class="footer-section">
                    <h4>Community</h4>
                    <ul>
                        <li><a href="https://discord.gg/Ywz5UYpf" target="_blank">Discord Server</a></li>
                        <li><a href="http://downloads.ira-chartarum.com/IraUpdater.zip" target="_blank">Download for Windows (ZIP)</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Development</h4>
                    <p>Created by a passionate 4-person indie team</p>
                    <p>Â© 2025 Ira Chartarum. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Image Modal -->
    <div id="imageModal" class="image-modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <img id="modalImage" src="" alt="" class="modal-image">
            <div class="modal-info">
                <h3 id="modalTitle"></h3>
                <span id="modalTag" class="modal-tag"></span>
                <p id="modalDescription"></p>
            </div>
        </div>
    </div>

    <script>
        // Image Modal Functionality
        const modal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const modalTitle = document.getElementById('modalTitle');
        const modalTag = document.getElementById('modalTag');
        const modalDescription = document.getElementById('modalDescription');
        const closeBtn = document.querySelector('.modal-close');

        // Function to open modal
        function openModal(imageSrc, title, tag, description) {
            modalImage.src = imageSrc;
            modalImage.alt = title;
            modalTitle.textContent = title;
            modalTag.textContent = tag || '';
            modalDescription.textContent = description || '';
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // Function to close modal
        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking X
        closeBtn.addEventListener('click', closeModal);

        // Close modal when clicking outside the image
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modal.style.display === 'flex') {
                closeModal();
            }
        });

        // Add click listeners to all mechanic images
        document.addEventListener('DOMContentLoaded', function() {
            // Mechanic section images
            const mechanicImages = document.querySelectorAll('.mechanic-image');
            mechanicImages.forEach(img => {
                img.style.cursor = 'pointer';
                img.addEventListener('click', function() {
                    const card = this.closest('.mechanic-card');
                    const title = card.querySelector('.mechanic-title').textContent;
                    const description = card.querySelector('.mechanic-description').textContent;
                    openModal(this.src, title, 'Game Mechanic', description);
                });
            });

            // Asset gallery images
            const assetImages = document.querySelectorAll('.primary-asset img');
            assetImages.forEach(img => {
                img.style.cursor = 'pointer';
                img.addEventListener('click', function() {
                    const asset = this.closest('.primary-asset');
                    const title = asset.querySelector('h4').textContent;
                    const tag = asset.querySelector('.asset-tag').textContent;
                    const description = asset.querySelector('.asset-info p').textContent;
                    openModal(this.src, title, tag, description);
                });
            });
        });
    </script>
</body>
</html>
